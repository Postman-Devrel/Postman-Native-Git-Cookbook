# Spectral ruleset for OpenAPI specs only.
# Targets files in postman/specs/ — does not apply to collections or environments.
#
# Run with:
#   npm run lint:specs
#
# Or directly:
#   spectral lint 'postman/specs/**/*.yaml' 'postman/specs/**/*.json' --ruleset .spectral-openapi.yaml

extends: [[spectral:oas, recommended]]

rules:
  # Require info.description — shows up in the API Catalog and published docs
  info-description: error

  # Require contact info on the spec
  info-contact: warn

  # Every operation must have a summary
  operation-summary: error

  # Every operation must have at least one tag
  operation-tags: error

  # Tags used on operations must be defined at the top level
  operation-tag-defined: error

  # Every operation must have a unique operationId
  operation-operationId: error

  # operationId must be URL-friendly (no spaces or special characters)
  operation-operationId-valid-in-url: error

  # Every operation must define at least one response
  operation-success-response: error

  # Parameters must have descriptions
  operation-parameters: warn

  # No $ref siblings — invalid in OpenAPI and silently ignored by most parsers
  no-$ref-siblings: error

  # Paths must not have trailing slashes
  path-not-include-query: error

  # Discourage deprecated operations without a description explaining the migration path
  operation-description: warn
